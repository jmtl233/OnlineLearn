{"remainingRequest":"E:\\OnlineLearn\\OnlineLearnVue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\OnlineLearn\\OnlineLearnVue\\src\\views\\scoremanagement\\Detail.vue?vue&type=style&index=0&id=56aee885&scoped=true&lang=css&","dependencies":[{"path":"E:\\OnlineLearn\\OnlineLearnVue\\src\\views\\scoremanagement\\Detail.vue","mtime":1746628523371},{"path":"E:\\OnlineLearn\\OnlineLearnVue\\node_modules\\css-loader\\dist\\cjs.js","mtime":1711182487975},{"path":"E:\\OnlineLearn\\OnlineLearnVue\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1711182506221},{"path":"E:\\OnlineLearn\\OnlineLearnVue\\node_modules\\postcss-loader\\src\\index.js","mtime":1711182496599},{"path":"E:\\OnlineLearn\\OnlineLearnVue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1711182484313},{"path":"E:\\OnlineLearn\\OnlineLearnVue\\node_modules\\vue-loader\\lib\\index.js","mtime":1711182506214}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoNCi5lbC1pbnB1dF9faW5uZXIgew0KICAgIG1hcmdpbi10b3A6IDEwcHg7DQp9DQoNCi5lbC10ZXh0YXJlYV9faW5uZXIgew0KICAgIG1hcmdpbi10b3A6IDEwcHg7DQp9DQoNCi5iYXNlLWluZm8gew0KICAgIG1hcmdpbi1ib3R0b206IDIwcHg7DQogICAgcGFkZGluZzogMTVweDsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZjlmOWY5Ow0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCn0NCg0KLnF1ZXN0aW9uLWxpc3Qgew0KICAgIG1hcmdpbi1ib3R0b206IDMwcHg7DQp9DQoNCi5xdWVzdGlvbi1pdGVtIHsNCiAgICBtYXJnaW4tYm90dG9tOiAyMHB4Ow0KfQ0KDQoucXVlc3Rpb24taGVhZGVyIHsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgbWFyZ2luLWJvdHRvbTogMTVweDsNCn0NCg0KLnF1ZXN0aW9uLXR5cGUgew0KICAgIGZvbnQtd2VpZ2h0OiBib2xkOw0KICAgIGZvbnQtc2l6ZTogMTZweDsNCiAgICBtYXJnaW4tcmlnaHQ6IDE1cHg7DQp9DQoNCi5vcHRpb24taXRlbSB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIG1hcmdpbi1ib3R0b206IDEwcHg7DQp9DQoNCi5hZGQtcXVlc3Rpb24gew0KICAgIHRleHQtYWxpZ246IGNlbnRlcjsNCiAgICBtYXJnaW46IDIwcHggMDsNCn0NCg0KLnNjb3JpbmctYXJlYSB7DQogICAgbWFyZ2luLXRvcDogMjBweDsNCiAgICBwYWRkaW5nOiAxNXB4Ow0KICAgIGJhY2tncm91bmQtY29sb3I6ICNmOWY5Zjk7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KfQ0KDQouZm9ybS1hY3Rpb25zIHsNCiAgICBtYXJnaW4tdG9wOiAyMHB4Ow0KICAgIHRleHQtYWxpZ246IHJpZ2h0Ow0KICAgIHBhZGRpbmctYm90dG9tOiAzMHB4Ow0KfQ0KDQouZGVsZXRlLWJ0biB7DQogICAgbWFyZ2luLWxlZnQ6IGF1dG87DQp9DQo="},{"version":3,"sources":["Detail.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+VA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"Detail.vue","sourceRoot":"src/views/scoremanagement","sourcesContent":["<template>\r\n    <div style=\"overflow-y: auto; padding: 20px;\">\r\n        <el-form ref=\"form\" :model=\"paramData\" label-width=\"100px\">\r\n            <!-- 试卷基本信息 -->\r\n            <div class=\"base-info\">\r\n                <el-form-item label=\"所属班级\" prop=\"classId\" required>\r\n                    <el-select\r\n                        v-model=\"paramData.classId\"\r\n                        filterable\r\n                        placeholder=\"请选择班级\"\r\n                        style=\"width: 300px\">\r\n                        <el-option\r\n                            v-for=\"item in queryCla\"\r\n                            :key=\"item.classId\"\r\n                            :label=\"item.className\"\r\n                            :value=\"item.classId\"/>\r\n                    </el-select>\r\n                </el-form-item>\r\n\r\n                <el-form-item :label=\"`${type}标题`\" prop=\"title\" required>\r\n                    <el-input\r\n                        v-model=\"paramData.title\"\r\n                        :placeholder=\"`请输入${type}标题`\"\r\n                        style=\"width: 400px\"\r\n                        clearable/>\r\n                </el-form-item>\r\n\r\n                <el-form-item label=\"考试时间\" prop=\"examTime\" required>\r\n                    <el-date-picker\r\n                        v-model=\"paramData.commitTime\"\r\n                        type=\"datetime\"\r\n                        value-format=\"yyyy-MM-dd HH:mm:ss\"\r\n                        placeholder=\"选择考试时间\"\r\n                        style=\"width: 300px\"/>\r\n                </el-form-item>\r\n\r\n                <el-form-item label=\"考试时长\" prop=\"duration\" required>\r\n                    <el-input-number\r\n                        v-model=\"paramData.duration\"\r\n                        :min=\"30\"\r\n                        :max=\"300\"\r\n                        controls-position=\"right\"\r\n                        style=\"width: 150px\"/>\r\n                    <span style=\"margin-left: 10px; color: #666\">分钟</span>\r\n                </el-form-item>\r\n            </div>\r\n\r\n            <!-- 试题编辑区域 -->\r\n            <div class=\"question-list\">\r\n                <div v-for=\"(question, index) in paramData.questions\" :key=\"index\" class=\"question-item\">\r\n                    <el-card shadow=\"hover\">\r\n                        <div class=\"question-header\">\r\n                            <span class=\"question-type\">题目 {{ index + 1 }}</span>\r\n                            <el-select\r\n                                v-model=\"question.type\"\r\n                                placeholder=\"题型\"\r\n                                style=\"width: 150px; margin: 0 20px\">\r\n                                <el-option\r\n                                    v-for=\"t in questionTypes\"\r\n                                    :key=\"t.value\"\r\n                                    :label=\"t.label\"\r\n                                    :value=\"t.value\"/>\r\n                            </el-select>\r\n\r\n                            <el-input-number\r\n                                v-model=\"question.score\"\r\n                                :min=\"1\"\r\n                                :max=\"50\"\r\n                                controls-position=\"right\"\r\n                                placeholder=\"分值\"\r\n                                style=\"width: 120px\"/>\r\n\r\n                            <el-button\r\n                                class=\"delete-btn\"\r\n                                type=\"danger\"\r\n                                icon=\"el-icon-delete\"\r\n                                circle\r\n                                @click=\"removeQuestion(index)\"/>\r\n                        </div>\r\n\r\n                        <el-form-item label=\"题目内容\" required>\r\n                            <mavon-editor\r\n                                v-model=\"question.content\"\r\n                                :subfield=\"false\"\r\n                                :autofocus=\"false\"\r\n                                style=\"margin: 10px 0;\"\r\n                                placeholder=\"请输入题目内容...\"/>\r\n                        </el-form-item>\r\n\r\n                        <el-form-item label=\"参考答案\" required>\r\n                            <template v-if=\"question.type === 'choice'\">\r\n                                <div v-for=\"(opt, oIndex) in question.options\" :key=\"oIndex\" class=\"option-item\">\r\n                                    <el-radio v-model=\"question.answer\" :label=\"String.fromCharCode(65 + oIndex)\">\r\n                                        {{ String.fromCharCode(65 + oIndex) }}.\r\n                                    </el-radio>\r\n                                    <el-input\r\n                                        v-model=\"question.options[oIndex]\"\r\n                                        style=\"width: 300px; margin-left: 10px\"/>\r\n                                </div>\r\n                                <el-button\r\n                                    type=\"primary\"\r\n                                    size=\"mini\"\r\n                                    @click=\"addOption(question)\">\r\n                                    添加选项\r\n                                </el-button>\r\n                            </template>\r\n\r\n                            <template v-else-if=\"question.type === 'blank'\">\r\n                                <el-input\r\n                                    v-model=\"question.answer\"\r\n                                    placeholder=\"请输入填空答案\"\r\n                                    style=\"width: 400px\"/>\r\n                            </template>\r\n\r\n                            <template v-else>\r\n                                <mavon-editor\r\n                                    v-model=\"question.answer\"\r\n                                    :subfield=\"false\"\r\n                                    :autofocus=\"false\"\r\n                                    style=\"margin: 10px 0;\"\r\n                                    placeholder=\"请输入参考答案...\"/>\r\n                            </template>\r\n                        </el-form-item>\r\n                    </el-card>\r\n                </div>\r\n\r\n                <div class=\"add-question\">\r\n                    <el-button type=\"primary\" icon=\"el-icon-plus\" @click=\"addQuestion\">添加题目</el-button>\r\n                </div>\r\n            </div>\r\n\r\n            <!-- 评分区域 -->\r\n            <div class=\"scoring-area\" v-if=\"check\">\r\n                <el-form-item label=\"评分\">\r\n                    <el-tooltip class=\"item\" effect=\"dark\" :content=\"mode == '已批改' ? '该作业已批改！' : '输入分数评分'\" placement=\"top-start\">\r\n                        <el-input\r\n                            :disabled=\"mode == '已批改'\"\r\n                            placeholder=\"请输入分数\"\r\n                            v-model=\"paramData.score\"\r\n                            style=\"width: 200px\">\r\n                        </el-input>\r\n                    </el-tooltip>\r\n                </el-form-item>\r\n\r\n                <el-form-item label=\"备注\">\r\n                    <el-input\r\n                        :disabled=\"mode == '已批改'\"\r\n                        type=\"textarea\"\r\n                        :rows=\"3\"\r\n                        placeholder=\"请输入备注\"\r\n                        v-model=\"paramData.remark\"\r\n                        style=\"width: 100%\">\r\n                    </el-input>\r\n                </el-form-item>\r\n            </div>\r\n\r\n            <!-- 操作按钮 -->\r\n            <div class=\"form-actions\">\r\n                <el-button type=\"danger\" @click=\"out()\">返回</el-button>\r\n                <el-tooltip class=\"item\" effect=\"dark\" :content=\"mode == '已批改' ? '该作业已批改！' : '提交'\" placement=\"top-start\">\r\n                    <el-button :disabled=\"mode == '已批改'\" type=\"success\" @click=\"addTest(paramData)\">提交</el-button>\r\n                </el-tooltip>\r\n            </div>\r\n        </el-form>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { pclass } from \"../../api/admin/queryclass\";\r\nimport { addt, saveHomework } from '../../api/teacher/test.js'\r\nimport Cookies from 'js-cookie'\r\n\r\nexport default {\r\n    name: \"Detail\",\r\n    data() {\r\n        return {\r\n            check: false,\r\n            mode: 0,\r\n            queryCla: [],\r\n            paramData: {\r\n                id: '',\r\n                classId: '',\r\n                title: '',\r\n                content: '',\r\n                commitTime: '',\r\n                answer: '',\r\n                creator: '',\r\n                userId: '',\r\n                score: 0,\r\n                remark: \"\",\r\n                duration: 60,\r\n                questions: []\r\n            },\r\n            param: {\r\n                userId: '',\r\n            },\r\n            tag: '',\r\n            studenttag: '',\r\n            type: \"试题\",\r\n            questionTypes: [\r\n                { value: 'choice', label: '选择题' },\r\n                { value: 'blank', label: '填空题' },\r\n                { value: 'essay', label: '问答题' }\r\n            ]\r\n        }\r\n    },\r\n    computed: {\r\n\r\n    },\r\n    created() {\r\n        this.paramData.creator = Cookies.get(\"userId\")\r\n        this.param.userId = Cookies.get(\"userId\")\r\n        this.queryClass(this.param)\r\n        this.type = this.$route.query.type\r\n        this.tag = this.$route.params.data1\r\n        this.check = this.$route.params.check\r\n        if (this.$route.params.data2) {\r\n            this.paramData.userId = this.$route.params.data2.userId\r\n            this.paramData.id = this.$route.params.data2.homeworkId\r\n            this.paramData.title = this.$route.params.data2.title\r\n            this.paramData.content = this.$route.params.data2.content\r\n            this.paramData.answer = this.$route.params.data2.answer\r\n            this.paramData.commitTime = this.$route.params.data2.commitTime\r\n            this.paramData.commitTime = this.$route.params.data2.completionTime\r\n            this.paramData.classId = this.$route.params.data2.classId\r\n            this.studenttag = this.$route.params.data4\r\n            this.mode = this.$route.params.data2.mode\r\n            this.paramData.remark = this.$route.params.data2.remark\r\n            this.paramData.score = this.$route.params.data2.score\r\n\r\n            // 如果有内容，创建一个默认题目\r\n            if (this.paramData.content) {\r\n                this.initQuestionsFromContent();\r\n            }\r\n        }\r\n\r\n        // 如果没有题目，添加一个默认题目\r\n        if (this.paramData.questions.length === 0) {\r\n            this.addQuestion();\r\n        }\r\n    },\r\n    methods: {\r\n        out() {\r\n            this.tag = this.$route.params.data1\r\n            if (this.tag == 'homework') {\r\n                console.log(this.tag, '888')\r\n                this.$router.push('/classmanagement')\r\n            } else {\r\n                this.$router.push('/scoremanagment')\r\n            }\r\n        },\r\n        queryClass(pa) {\r\n            pclass(pa).then(resp => {\r\n                this.queryCla = resp.data.resultData\r\n            })\r\n        },\r\n        addTest(paramData) {\r\n            // 将题目内容合并到content字段\r\n            this.prepareDataForSubmit();\r\n\r\n            this.tag = this.$route.params.data1\r\n            if (this.tag == 'homework') {\r\n                saveHomework(paramData).then(resp => {\r\n                    if (resp.data.code == 200) {\r\n                        this.$router.push(\"/classmanagement\")\r\n                        this.$message({\r\n                            message: '发布成功',\r\n                            type: 'success'\r\n                        });\r\n                    } else {\r\n                        this.$message.error('发布失败');\r\n                    }\r\n                })\r\n            } else {\r\n                addt(paramData).then(resp => {\r\n                    if (resp.data.code == 200) {\r\n                        this.$router.push(\"/scoremanagment\")\r\n                        this.$message({\r\n                            message: '发布成功',\r\n                            type: 'success'\r\n                        });\r\n                    } else {\r\n                        this.$message.error('发布失败');\r\n                    }\r\n                })\r\n            }\r\n        },\r\n        // 添加新题目\r\n        addQuestion() {\r\n            this.paramData.questions.push({\r\n                type: 'essay',\r\n                content: '',\r\n                answer: '',\r\n                score: 10,\r\n                options: ['', '', '', '']\r\n            });\r\n        },\r\n        // 删除题目\r\n        removeQuestion(index) {\r\n            this.paramData.questions.splice(index, 1);\r\n            if (this.paramData.questions.length === 0) {\r\n                this.addQuestion();\r\n            }\r\n        },\r\n        // 添加选项\r\n        addOption(question) {\r\n            if (!question.options) {\r\n                question.options = [];\r\n            }\r\n            question.options.push('');\r\n        },\r\n        // 从现有内容初始化题目\r\n        initQuestionsFromContent() {\r\n            this.paramData.questions = [{\r\n                type: 'essay',\r\n                content: this.paramData.content,\r\n                answer: this.paramData.answer,\r\n                score: 100,\r\n                options: []\r\n            }];\r\n        },\r\n        // 准备提交数据\r\n        prepareDataForSubmit() {\r\n            // 如果使用了新的题目格式，需要将题目合并到content和answer字段\r\n            if (this.paramData.questions && this.paramData.questions.length > 0) {\r\n                let contentText = '';\r\n                let answerText = '';\r\n\r\n                this.paramData.questions.forEach((q, index) => {\r\n                    contentText += `## 题目 ${index + 1}：${q.type === 'choice' ? '(选择题)' : q.type === 'blank' ? '(填空题)' : '(问答题)'}\\n\\n`;\r\n                    contentText += q.content + '\\n\\n';\r\n\r\n                    if (q.type === 'choice' && q.options) {\r\n                        q.options.forEach((opt, i) => {\r\n                            contentText += `${String.fromCharCode(65 + i)}. ${opt}\\n`;\r\n                        });\r\n                    }\r\n\r\n                    answerText += `## 题目 ${index + 1} 答案：\\n\\n`;\r\n                    answerText += q.answer + '\\n\\n';\r\n                });\r\n\r\n                this.paramData.content = contentText;\r\n                this.paramData.answer = answerText;\r\n            }\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.el-input__inner {\r\n    margin-top: 10px;\r\n}\r\n\r\n.el-textarea__inner {\r\n    margin-top: 10px;\r\n}\r\n\r\n.base-info {\r\n    margin-bottom: 20px;\r\n    padding: 15px;\r\n    background-color: #f9f9f9;\r\n    border-radius: 4px;\r\n}\r\n\r\n.question-list {\r\n    margin-bottom: 30px;\r\n}\r\n\r\n.question-item {\r\n    margin-bottom: 20px;\r\n}\r\n\r\n.question-header {\r\n    display: flex;\r\n    align-items: center;\r\n    margin-bottom: 15px;\r\n}\r\n\r\n.question-type {\r\n    font-weight: bold;\r\n    font-size: 16px;\r\n    margin-right: 15px;\r\n}\r\n\r\n.option-item {\r\n    display: flex;\r\n    align-items: center;\r\n    margin-bottom: 10px;\r\n}\r\n\r\n.add-question {\r\n    text-align: center;\r\n    margin: 20px 0;\r\n}\r\n\r\n.scoring-area {\r\n    margin-top: 20px;\r\n    padding: 15px;\r\n    background-color: #f9f9f9;\r\n    border-radius: 4px;\r\n}\r\n\r\n.form-actions {\r\n    margin-top: 20px;\r\n    text-align: right;\r\n    padding-bottom: 30px;\r\n}\r\n\r\n.delete-btn {\r\n    margin-left: auto;\r\n}\r\n</style>"]}]}