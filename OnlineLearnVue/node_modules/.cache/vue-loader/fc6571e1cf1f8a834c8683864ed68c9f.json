{"remainingRequest":"E:\\OnlineLearn\\OnlineLearnVue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\OnlineLearn\\OnlineLearnVue\\src\\views\\studentweb\\studentmanagement\\StudentManagement.vue?vue&type=style&index=0&id=7a5fca1e&lang=scss&scoped=true&","dependencies":[{"path":"E:\\OnlineLearn\\OnlineLearnVue\\src\\views\\studentweb\\studentmanagement\\StudentManagement.vue","mtime":1744879643649},{"path":"E:\\OnlineLearn\\OnlineLearnVue\\node_modules\\css-loader\\dist\\cjs.js","mtime":1711182487975},{"path":"E:\\OnlineLearn\\OnlineLearnVue\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1711182506221},{"path":"E:\\OnlineLearn\\OnlineLearnVue\\node_modules\\postcss-loader\\src\\index.js","mtime":1711182496599},{"path":"E:\\OnlineLearn\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\OnlineLearn\\OnlineLearnVue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1711182484313},{"path":"E:\\OnlineLearn\\OnlineLearnVue\\node_modules\\vue-loader\\lib\\index.js","mtime":1711182506214}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKDQoucGFnZS1jb250YWluZXIgew0KICAgIG1pbi1oZWlnaHQ6IDEwMHZoOw0KICAgIGJhY2tncm91bmQ6ICNmMGYyZjU7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsNCiAgICBwYWRkaW5nOiAyNHB4Ow0KfQ0KDQouY29udGVudC13cmFwcGVyIHsNCiAgICB3aWR0aDogMTAwJTsNCiAgICBtYXgtd2lkdGg6IDEyMDBweDsNCiAgICBiYWNrZ3JvdW5kOiAjZmZmZmZmOw0KICAgIGJvcmRlci1yYWRpdXM6IDEycHg7DQogICAgYm94LXNoYWRvdzogMCA0cHggMTJweCByZ2JhKDAsIDAsIDAsIDAuMDUpOw0KICAgIHBhZGRpbmc6IDI0cHg7DQp9DQoNCi5oZWFkZXItc2VjdGlvbiB7DQogICAgbWFyZ2luLWJvdHRvbTogMzJweDsNCg0KICAgIC5hcHBsaWNhdGlvbi1idG4gew0KICAgICAgICB3aWR0aDogMTYwcHg7DQogICAgICAgIGZvbnQtd2VpZ2h0OiA1MDA7DQogICAgICAgIGxldHRlci1zcGFjaW5nOiAwLjVweDsNCiAgICB9DQoNCiAgICAuY3VzdG9tLWRpdmlkZXIgew0KICAgICAgICBtYXJnaW46IDE2cHggMDsNCiAgICAgICAgYmFja2dyb3VuZDogI2U4ZThlODsNCiAgICB9DQp9DQoNCi5jbGFzcy1saXN0IHsNCiAgICBkaXNwbGF5OiBncmlkOw0KICAgIGdhcDogMTZweDsNCn0NCg0KLmNsYXNzLWNhcmQgew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOw0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgcGFkZGluZzogMjBweDsNCiAgICBiYWNrZ3JvdW5kOiAjZmFmYWZhOw0KICAgIGJvcmRlci1yYWRpdXM6IDhweDsNCiAgICB0cmFuc2l0aW9uOiBhbGwgMC4yczsNCiAgICBib3JkZXI6IDFweCBzb2xpZCAjZWJlZWY1Ow0KDQogICAgJjpob3ZlciB7DQogICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtMnB4KTsNCiAgICAgICAgYm94LXNoYWRvdzogMCA0cHggMTJweCByZ2JhKDAsIDAsIDAsIDAuMDgpOw0KICAgIH0NCg0KICAgIC5jbGFzcy1pbmZvIHsNCiAgICAgICAgZGlzcGxheTogZmxleDsNCiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICAgICAgZ2FwOiAxNnB4Ow0KDQogICAgICAgIC5jbGFzcy10YWcgew0KICAgICAgICAgICAgZm9udC1zaXplOiAyNHB4Ow0KICAgICAgICAgICAgcGFkZGluZzogMTJweDsNCiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDhweDsNCiAgICAgICAgfQ0KDQogICAgICAgIC5jbGFzcy1kZXRhaWxzIHsNCiAgICAgICAgICAgIC5jbGFzcy1uYW1lIHsNCiAgICAgICAgICAgICAgICBtYXJnaW46IDA7DQogICAgICAgICAgICAgICAgZm9udC1zaXplOiAxOHB4Ow0KICAgICAgICAgICAgICAgIGNvbG9yOiAjMzAzMTMzOw0KICAgICAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiA2MDA7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC5tZXRhLWluZm8gew0KICAgICAgICAgICAgICAgIG1hcmdpbjogOHB4IDAgMDsNCiAgICAgICAgICAgICAgICBjb2xvcjogIzkwOTM5OTsNCiAgICAgICAgICAgICAgICBmb250LXNpemU6IDEzcHg7DQogICAgICAgICAgICAgICAgZGlzcGxheTogZmxleDsNCiAgICAgICAgICAgICAgICBnYXA6IDE2cHg7DQoNCiAgICAgICAgICAgICAgICBpIHsNCiAgICAgICAgICAgICAgICAgICAgbWFyZ2luLXJpZ2h0OiA0cHg7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KDQogICAgLmpvaW4tYnRuIHsNCiAgICAgICAgd2lkdGg6IDEyMHB4Ow0KICAgICAgICBib3JkZXItcmFkaXVzOiAyMHB4Ow0KICAgICAgICBmb250LXdlaWdodDogNTAwOw0KICAgIH0NCn0NCg0KLmVtcHR5LXN0YXRlIHsNCiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7DQogICAgcGFkZGluZzogNDhweCAwOw0KDQogICAgLmVtcHR5LWltYWdlIHsNCiAgICAgICAgd2lkdGg6IDIwMHB4Ow0KICAgICAgICBvcGFjaXR5OiAwLjY7DQogICAgICAgIG1hcmdpbi1ib3R0b206IDE2cHg7DQogICAgfQ0KDQogICAgLmVtcHR5LXRleHQgew0KICAgICAgICBjb2xvcjogIzkwOTM5OTsNCiAgICAgICAgZm9udC1zaXplOiAxNHB4Ow0KICAgIH0NCn0NCg0KLnBhZ2luYXRpb24td3JhcHBlciB7DQogICAgbWFyZ2luLXRvcDogMzJweDsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGp1c3RpZnktY29udGVudDogZmxleC1lbmQ7DQp9DQoNCi5wb3BvdmVyLWNvbnRlbnQgew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBnYXA6IDhweDsNCiAgICBjb2xvcjogIzYwNjI2NjsNCg0KICAgIGkgew0KICAgICAgICBjb2xvcjogI2U2YTIzYzsNCiAgICB9DQp9DQo="},{"version":3,"sources":["StudentManagement.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuMA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"StudentManagement.vue","sourceRoot":"src/views/studentweb/studentmanagement","sourcesContent":["<template>\r\n    <div class=\"page-container\">\r\n        <div class=\"content-wrapper\">\r\n            <div class=\"header-section\">\r\n                <el-button\r\n                    type=\"primary\"\r\n                    icon=\"el-icon-notebook-2\"\r\n                    @click=\"$router.push('/applicanthistory')\"\r\n                    class=\"application-btn\"\r\n                >\r\n                    申请记录\r\n                </el-button>\r\n                <el-divider class=\"custom-divider\"></el-divider>\r\n            </div>\r\n\r\n            <el-skeleton :loading=\"loading\" animated :count=\"3\">\r\n                <template #default>\r\n                    <div class=\"class-list\">\r\n                        <div\r\n                            v-for=\"s in StudentClassData\"\r\n                            :key=\"s.id\"\r\n                            class=\"class-card\"\r\n                        >\r\n                            <div class=\"class-info\">\r\n                                <el-tag type=\"success\" effect=\"dark\" class=\"class-tag\">\r\n                                    <i class=\"el-icon-school\"></i>\r\n                                </el-tag>\r\n                                <div class=\"class-details\">\r\n                                    <h3 class=\"class-name\">{{ s.className }}</h3>\r\n                                    <p class=\"meta-info\">\r\n                    <span class=\"teacher\">\r\n                      <i class=\"el-icon-user\"></i> 班主任：{{ s.teacherName }}\r\n                    </span>\r\n                                        <span class=\"student-count\">\r\n                      <i class=\"el-icon-user-solid\"></i> 学生数：{{ s.studentCount }}\r\n                    </span>\r\n                                    </p>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <el-popover\r\n                                placement=\"top-end\"\r\n                                width=\"200\"\r\n                                trigger=\"hover\"\r\n                                :disabled=\"!joinDisabled\"\r\n                            >\r\n                                <template #reference>\r\n                                    <el-button\r\n                                        type=\"primary\"\r\n                                        :disabled=\"joinDisabled\"\r\n                                        :loading=\"loadingJoin\"\r\n                                        @click=\"handleJoinClass(s)\"\r\n                                        class=\"join-btn\"\r\n                                    >\r\n                                        {{ joinButtonText(s) }}\r\n                                    </el-button>\r\n                                </template>\r\n                                <div class=\"popover-content\">\r\n                                    <i class=\"el-icon-info\"></i>\r\n                                    <span v-if=\"hasPendingApplication\">您有加入{{ pendingClassName }}的申请正在审核中</span>\r\n                                    <span v-else>已加入{{ currentClassName }}班级</span>\r\n                                </div>\r\n                            </el-popover>\r\n                        </div>\r\n\r\n                        <div v-if=\"!StudentClassData.length\" class=\"empty-state\">\r\n                            <img src=\"@/assets/empty-class.png\" alt=\"空状态\" class=\"empty-image\">\r\n                            <p class=\"empty-text\">暂时没有可加入的班级</p>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div class=\"pagination-wrapper\">\r\n                        <el-pagination\r\n                            background\r\n                            @size-change=\"handleSizeChange\"\r\n                            @current-change=\"handleCurrentChange\"\r\n                            :current-page=\"pagination.current\"\r\n                            :page-sizes=\"[10, 20, 30, 40]\"\r\n                            :page-size=\"pagination.pageSize\"\r\n                            layout=\"total, sizes, prev, pager, next, jumper\"\r\n                            :total=\"pagination.total\"\r\n                        />\r\n                    </div>\r\n                </template>\r\n            </el-skeleton>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, computed, onMounted } from 'vue'\r\nimport { useStore } from 'vuex'\r\nimport { ElMessage } from 'element-plus'\r\nimport {\r\n    fetchClasses,\r\n    applyJoinClass,\r\n    checkApplicationStatus\r\n} from '@/api/classService'\r\n\r\nexport default {\r\n    setup() {\r\n        const store = useStore()\r\n        const loading = ref(true)\r\n        const loadingJoin = ref(false)\r\n        const StudentClassData = ref([])\r\n\r\n        const pagination = ref({\r\n            current: 1,\r\n            pageSize: 10,\r\n            total: 0\r\n        })\r\n\r\n        const userStatus = ref({\r\n            hasClass: false,\r\n            pendingApplication: null,\r\n            currentClass: null\r\n        })\r\n\r\n        const joinDisabled = computed(() => {\r\n            return userStatus.value.hasClass || !!userStatus.value.pendingApplication\r\n        })\r\n\r\n        const fetchData = async () => {\r\n            try {\r\n                loading.value = true\r\n                const params = {\r\n                    page: pagination.value.current,\r\n                    pageSize: pagination.value.pageSize\r\n                }\r\n                const { data } = await fetchClasses(params)\r\n                StudentClassData.value = data.records\r\n                pagination.value.total = data.total\r\n            } catch (error) {\r\n                ElMessage.error('获取班级列表失败')\r\n            } finally {\r\n                loading.value = false\r\n            }\r\n        }\r\n\r\n        const checkUserStatus = async () => {\r\n            const userId = store.state.user.id\r\n            const { data } = await checkApplicationStatus(userId)\r\n            userStatus.value = {\r\n                hasClass: data.hasClass,\r\n                pendingApplication: data.pendingApplication,\r\n                currentClass: data.currentClass\r\n            }\r\n        }\r\n\r\n        const handleJoinClass = async (classInfo) => {\r\n            try {\r\n                loadingJoin.value = true\r\n                await applyJoinClass({\r\n                    classId: classInfo.id,\r\n                    userId: store.state.user.id\r\n                })\r\n                await checkUserStatus()\r\n                ElMessage.success('加入申请已提交，请等待审核')\r\n            } catch (error) {\r\n                ElMessage.error(error.message || '申请提交失败')\r\n            } finally {\r\n                loadingJoin.value = false\r\n            }\r\n        }\r\n\r\n        const joinButtonText = (classInfo) => {\r\n            if (userStatus.value.pendingApplication?.classId === classInfo.id) {\r\n                return '审核中'\r\n            }\r\n            return '加入班级'\r\n        }\r\n\r\n        onMounted(async () => {\r\n            await Promise.all([fetchData(), checkUserStatus()])\r\n        })\r\n\r\n        return {\r\n            loading,\r\n            loadingJoin,\r\n            StudentClassData,\r\n            pagination,\r\n            joinDisabled,\r\n            userStatus,\r\n            handleJoinClass,\r\n            joinButtonText,\r\n            handleSizeChange: (size) => {\r\n                pagination.value.pageSize = size\r\n                fetchData()\r\n            },\r\n            handleCurrentChange: (page) => {\r\n                pagination.value.current = page\r\n                fetchData()\r\n            }\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.page-container {\r\n    min-height: 100vh;\r\n    background: #f0f2f5;\r\n    display: flex;\r\n    justify-content: center;\r\n    padding: 24px;\r\n}\r\n\r\n.content-wrapper {\r\n    width: 100%;\r\n    max-width: 1200px;\r\n    background: #ffffff;\r\n    border-radius: 12px;\r\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);\r\n    padding: 24px;\r\n}\r\n\r\n.header-section {\r\n    margin-bottom: 32px;\r\n\r\n    .application-btn {\r\n        width: 160px;\r\n        font-weight: 500;\r\n        letter-spacing: 0.5px;\r\n    }\r\n\r\n    .custom-divider {\r\n        margin: 16px 0;\r\n        background: #e8e8e8;\r\n    }\r\n}\r\n\r\n.class-list {\r\n    display: grid;\r\n    gap: 16px;\r\n}\r\n\r\n.class-card {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n    padding: 20px;\r\n    background: #fafafa;\r\n    border-radius: 8px;\r\n    transition: all 0.2s;\r\n    border: 1px solid #ebeef5;\r\n\r\n    &:hover {\r\n        transform: translateY(-2px);\r\n        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);\r\n    }\r\n\r\n    .class-info {\r\n        display: flex;\r\n        align-items: center;\r\n        gap: 16px;\r\n\r\n        .class-tag {\r\n            font-size: 24px;\r\n            padding: 12px;\r\n            border-radius: 8px;\r\n        }\r\n\r\n        .class-details {\r\n            .class-name {\r\n                margin: 0;\r\n                font-size: 18px;\r\n                color: #303133;\r\n                font-weight: 600;\r\n            }\r\n\r\n            .meta-info {\r\n                margin: 8px 0 0;\r\n                color: #909399;\r\n                font-size: 13px;\r\n                display: flex;\r\n                gap: 16px;\r\n\r\n                i {\r\n                    margin-right: 4px;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    .join-btn {\r\n        width: 120px;\r\n        border-radius: 20px;\r\n        font-weight: 500;\r\n    }\r\n}\r\n\r\n.empty-state {\r\n    text-align: center;\r\n    padding: 48px 0;\r\n\r\n    .empty-image {\r\n        width: 200px;\r\n        opacity: 0.6;\r\n        margin-bottom: 16px;\r\n    }\r\n\r\n    .empty-text {\r\n        color: #909399;\r\n        font-size: 14px;\r\n    }\r\n}\r\n\r\n.pagination-wrapper {\r\n    margin-top: 32px;\r\n    display: flex;\r\n    justify-content: flex-end;\r\n}\r\n\r\n.popover-content {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 8px;\r\n    color: #606266;\r\n\r\n    i {\r\n        color: #e6a23c;\r\n    }\r\n}\r\n</style>"]}]}