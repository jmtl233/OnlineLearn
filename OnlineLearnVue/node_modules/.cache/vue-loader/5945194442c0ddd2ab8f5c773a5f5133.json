{"remainingRequest":"E:\\OnlineLearn\\OnlineLearnVue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\OnlineLearn\\OnlineLearnVue\\src\\views\\coursemanagement\\CourseManagement.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\OnlineLearn\\OnlineLearnVue\\src\\views\\coursemanagement\\CourseManagement.vue","mtime":1747380793765},{"path":"E:\\OnlineLearn\\OnlineLearnVue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1711182484313},{"path":"E:\\OnlineLearn\\OnlineLearnVue\\node_modules\\babel-loader\\lib\\index.js","mtime":1711182482575},{"path":"E:\\OnlineLearn\\OnlineLearnVue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1711182484313},{"path":"E:\\OnlineLearn\\OnlineLearnVue\\node_modules\\vue-loader\\lib\\index.js","mtime":1711182506214}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgeyBsaXN0QWxsU2hkdWxlLCBhZGRTaGR1bGUgfSBmcm9tICIuLi8uLi9hcGkvc2hkdWxlIjsNCmltcG9ydCBDb29raWVzIGZyb20gImpzLWNvb2tpZSI7DQoNCmV4cG9ydCBkZWZhdWx0IHsNCiAgICBuYW1lOiAiQ291cnNlTWFuYWdlbWVudCIsDQogICAgZGF0YSgpIHsNCiAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgIHNoZHVsZURhdGE6IFtdLA0KICAgICAgICAgICAgdG90YWxDb3VudDogMCwNCiAgICAgICAgICAgIHBhZ2U6IHsNCiAgICAgICAgICAgICAgICBwYWdlOiAxLA0KICAgICAgICAgICAgICAgIHBhZ2VTaXplOiAxMCwNCiAgICAgICAgICAgICAgICB1c2VySWQ6IENvb2tpZXMuZ2V0KCd1c2VySWQnKQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfSwNCiAgICBjcmVhdGVkKCkgew0KICAgICAgICB0aGlzLmxpc3RTaGR1bGUoKQ0KICAgIH0sDQogICAgbWV0aG9kczogew0KICAgICAgICAvLyDlm57lpI3lip/og70NCiAgICAgICAgYXN5bmMgcmVzdG9yKGl0ZW0pIHsNCiAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgLy8g5L+d5a2Y5Y6f5aeL54q25oCB55So5LqO6ZSZ6K+v5Zue5ruaDQogICAgICAgICAgICAgICAgY29uc3Qgb3JpZ2luYWxTdGF0dXMgPSBpdGVtLnN0YXR1cw0KICAgICAgICAgICAgICAgIGNvbnN0IG9yaWdpbmFsUmVzdG9yZSA9IGl0ZW0ucmVzdG9yZQ0KDQogICAgICAgICAgICAgICAgLy8g56uL5Y2z5pu05paw5pys5Zyw54q25oCBDQogICAgICAgICAgICAgICAgaXRlbS5zdGF0dXMgPSAxDQogICAgICAgICAgICAgICAgaXRlbS5yZXN0b3JlID0gaXRlbS5yZXN0b3JlIHx8ICcnDQoNCiAgICAgICAgICAgICAgICBjb25zdCB7IGRhdGEgfSA9IGF3YWl0IGFkZFNoZHVsZShpdGVtKQ0KICAgICAgICAgICAgICAgIGlmIChkYXRhLmNvZGUgPT09IDIwMCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoJ+WbnuWkjeaIkOWKnycpDQogICAgICAgICAgICAgICAgICAgIC8vIOWQiOW5tuaOpeWPo+i/lOWbnueahOacgOaWsOaVsOaNrg0KICAgICAgICAgICAgICAgICAgICBPYmplY3QuYXNzaWduKGl0ZW0sIGRhdGEucmVzdWx0RGF0YSkNCiAgICAgICAgICAgICAgICAgICAgLy8g6YeN5paw6I635Y+W5YiX6KGo56Gu5L+d5pWw5o2u5LiA6Ie0DQogICAgICAgICAgICAgICAgICAgIHRoaXMubGlzdFNoZHVsZSgpDQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgLy8g5Zue5rua54q25oCBDQogICAgICAgICAgICAgICAgICAgIGl0ZW0uc3RhdHVzID0gb3JpZ2luYWxTdGF0dXMNCiAgICAgICAgICAgICAgICAgICAgaXRlbS5yZXN0b3JlID0gb3JpZ2luYWxSZXN0b3JlDQogICAgICAgICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+WbnuWkjeWksei0pScpDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCflm57lpI3lpLHotKU6JywgZXJyb3IpDQogICAgICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcign5Zue5aSN5aSx6LSlJykNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCg0KICAgICAgICAvLyDojrflj5bmlbDmja7liJfooagNCiAgICAgICAgYXN5bmMgbGlzdFNoZHVsZSgpIHsNCiAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgY29uc3QgeyBkYXRhIH0gPSBhd2FpdCBsaXN0QWxsU2hkdWxlKHRoaXMucGFnZSkNCiAgICAgICAgICAgICAgICBpZiAoZGF0YS5jb2RlID09PSAyMDApIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5zaGR1bGVEYXRhID0gZGF0YS5yZXN1bHREYXRhLmRhdGENCiAgICAgICAgICAgICAgICAgICAgdGhpcy50b3RhbENvdW50ID0gZGF0YS5yZXN1bHREYXRhLnRvdGFsDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCfojrflj5bmlbDmja7lpLHotKU6JywgZXJyb3IpDQogICAgICAgICAgICB9DQogICAgICAgIH0sDQoNCiAgICAgICAgaGFuZGxlU2l6ZUNoYW5nZShzaXplKSB7DQogICAgICAgICAgICB0aGlzLnBhZ2UucGFnZVNpemUgPSBzaXplDQogICAgICAgICAgICB0aGlzLmxpc3RTaGR1bGUoKQ0KICAgICAgICB9LA0KDQogICAgICAgIGhhbmRsZUN1cnJlbnRDaGFuZ2UocGFnZSkgew0KICAgICAgICAgICAgdGhpcy5wYWdlLnBhZ2UgPSBwYWdlDQogICAgICAgICAgICB0aGlzLmxpc3RTaGR1bGUoKQ0KICAgICAgICB9DQogICAgfQ0KfQ0K"},{"version":3,"sources":["CourseManagement.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkHA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA","file":"CourseManagement.vue","sourceRoot":"src/views/coursemanagement","sourcesContent":["<template>\r\n    <div class=\"communication-container\">\r\n        <div\r\n            v-if=\"shduleData.length <= 0\"\r\n            class=\"empty-state\"\r\n        >\r\n            <i class=\"el-icon-document\"></i>\r\n            <span>暂无沟通记录</span>\r\n        </div>\r\n\r\n        <el-timeline v-else>\r\n            <el-timeline-item\r\n                v-for=\"t in shduleData\"\r\n                :key=\"t.id\"\r\n                :timestamp=\"t.createTime\"\r\n                placement=\"top\"\r\n                :color=\"t.status === 1 ? '#67C23A' : '#E6A23C'\"\r\n            >\r\n                <el-card\r\n                    :class=\"['message-card', t.status === 1 ? 'answered' : 'pending']\"\r\n                    shadow=\"hover\"\r\n                >\r\n                    <!-- 状态标签 -->\r\n                    <div class=\"status-tag\">\r\n                        <el-tag\r\n                            :type=\"t.status === 1 ? 'success' : 'warning'\"\r\n                            effect=\"dark\"\r\n                        >\r\n                            {{ t.status === 1 ? '已回复' : '待回复' }}\r\n                        </el-tag>\r\n                    </div>\r\n\r\n                    <!-- 沟通主体 -->\r\n                    <div class=\"communication-body\">\r\n                        <div class=\"participants\">\r\n                            <div class=\"participant\">\r\n                                <span class=\"name\">{{ t.senderName }}</span>\r\n                                <el-tag type=\"info\" size=\"mini\">提问者</el-tag>\r\n                            </div>\r\n                            <div class=\"participant\">\r\n                                <span class=\"name\">{{ t.recipientName }}</span>\r\n                                <el-tag type=\"info\" size=\"mini\">回答者</el-tag>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <el-divider content-position=\"left\">问题详情</el-divider>\r\n\r\n                        <div class=\"content-section\">\r\n                            <div class=\"question\">\r\n                                <h4 class=\"section-title\">\r\n                                    <i class=\"el-icon-question\"></i>\r\n                                    问题描述\r\n                                </h4>\r\n                                <el-input\r\n                                    type=\"textarea\"\r\n                                    :rows=\"2\"\r\n                                    :value=\"t.content\"\r\n                                    readonly\r\n                                    resize=\"none\"\r\n                                    class=\"readonly-input\"\r\n                                ></el-input>\r\n                            </div>\r\n\r\n                            <div class=\"answer\">\r\n                                <h4 class=\"section-title\">\r\n                                    <i class=\"el-icon-chat-dot-round\"></i>\r\n                                    {{ t.status === 1 ? '回复内容' : '等待回复' }}\r\n                                </h4>\r\n                                <el-input\r\n                                    type=\"textarea\"\r\n                                    :rows=\"2\"\r\n                                    v-model=\"t.restore\"\r\n                                    :readonly=\"t.status === 1\"\r\n                                    :class=\"{'answered-input': t.status === 1}\"\r\n                                    :placeholder=\"t.status === 1 ? '' : '请输入回复内容'\"\r\n                                ></el-input>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <!-- 操作按钮 -->\r\n                        <div class=\"action-bar\">\r\n                            <el-button\r\n                                v-if=\"t.status !== 1\"\r\n                                type=\"success\"\r\n                                icon=\"el-icon-check\"\r\n                                @click=\"restor(t)\"\r\n                            >\r\n                                提交回复\r\n                            </el-button>\r\n                            <div v-else class=\"answered-time\">\r\n                                <i class=\"el-icon-success\"></i>\r\n                                <span>已回复于 {{ t.updateTime }}</span>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </el-card>\r\n            </el-timeline-item>\r\n        </el-timeline>\r\n\r\n        <el-pagination\r\n            v-if=\"shduleData.length > 0\"\r\n            @size-change=\"handleSizeChange\"\r\n            @current-change=\"handleCurrentChange\"\r\n            :current-page=\"page.page\"\r\n            :page-sizes=\"[10, 20, 30, 40]\"\r\n            :page-size=\"page.pageSize\"\r\n            layout=\"total, sizes, prev, pager, next, jumper\"\r\n            :total=\"totalCount\"\r\n            class=\"pagination\"\r\n        ></el-pagination>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { listAllShdule, addShdule } from \"../../api/shdule\";\r\nimport Cookies from \"js-cookie\";\r\n\r\nexport default {\r\n    name: \"CourseManagement\",\r\n    data() {\r\n        return {\r\n            shduleData: [],\r\n            totalCount: 0,\r\n            page: {\r\n                page: 1,\r\n                pageSize: 10,\r\n                userId: Cookies.get('userId')\r\n            }\r\n        }\r\n    },\r\n    created() {\r\n        this.listShdule()\r\n    },\r\n    methods: {\r\n        // 回复功能\r\n        async restor(item) {\r\n            try {\r\n                // 保存原始状态用于错误回滚\r\n                const originalStatus = item.status\r\n                const originalRestore = item.restore\r\n\r\n                // 立即更新本地状态\r\n                item.status = 1\r\n                item.restore = item.restore || ''\r\n\r\n                const { data } = await addShdule(item)\r\n                if (data.code === 200) {\r\n                    this.$message.success('回复成功')\r\n                    // 合并接口返回的最新数据\r\n                    Object.assign(item, data.resultData)\r\n                    // 重新获取列表确保数据一致\r\n                    this.listShdule()\r\n                } else {\r\n                    // 回滚状态\r\n                    item.status = originalStatus\r\n                    item.restore = originalRestore\r\n                    this.$message.error('回复失败')\r\n                }\r\n            } catch (error) {\r\n                console.error('回复失败:', error)\r\n                this.$message.error('回复失败')\r\n            }\r\n        },\r\n\r\n        // 获取数据列表\r\n        async listShdule() {\r\n            try {\r\n                const { data } = await listAllShdule(this.page)\r\n                if (data.code === 200) {\r\n                    this.shduleData = data.resultData.data\r\n                    this.totalCount = data.resultData.total\r\n                }\r\n            } catch (error) {\r\n                console.error('获取数据失败:', error)\r\n            }\r\n        },\r\n\r\n        handleSizeChange(size) {\r\n            this.page.pageSize = size\r\n            this.listShdule()\r\n        },\r\n\r\n        handleCurrentChange(page) {\r\n            this.page.page = page\r\n            this.listShdule()\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n/* 原有样式保持不变 */\r\n.communication-container {\r\n    max-width: 1200px;\r\n    margin: 0 auto;\r\n    padding: 30px 20px;\r\n}\r\n\r\n.empty-state {\r\n    text-align: center;\r\n    padding: 60px 0;\r\n    color: #909399;\r\n    font-size: 18px;\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;\r\n}\r\n\r\n.empty-state i {\r\n    font-size: 48px;\r\n    margin-bottom: 20px;\r\n}\r\n\r\n.message-card {\r\n    position: relative;\r\n    border-radius: 8px;\r\n    margin: 10px 0;\r\n}\r\n\r\n.message-card.answered {\r\n    border-left: 3px solid #67C23A;\r\n}\r\n\r\n.message-card.pending {\r\n    border-left: 3px solid #E6A23C;\r\n}\r\n\r\n.status-tag {\r\n    position: absolute;\r\n    right: 20px;\r\n    top: -10px;\r\n}\r\n\r\n.participants {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    padding: 10px 0;\r\n}\r\n\r\n.participant {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 8px;\r\n}\r\n\r\n.name {\r\n    font-weight: 500;\r\n    color: #303133;\r\n}\r\n\r\n.content-section {\r\n    margin: 20px 0;\r\n}\r\n\r\n.section-title {\r\n    color: #606266;\r\n    font-size: 14px;\r\n    margin: 10px 0;\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 6px;\r\n}\r\n\r\n.readonly-input >>> .el-textarea__inner {\r\n    background-color: #f5f7fa;\r\n    cursor: default;\r\n}\r\n\r\n.answered-input >>> .el-textarea__inner {\r\n    background-color: #f6ffed;\r\n    border-color: #b7eb8f;\r\n}\r\n\r\n.action-bar {\r\n    margin-top: 20px;\r\n    display: flex;\r\n    justify-content: flex-end;\r\n}\r\n\r\n.answered-time {\r\n    color: #67C23A;\r\n    font-size: 13px;\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 5px;\r\n}\r\n\r\n.pagination {\r\n    margin-top: 30px;\r\n    text-align: center;\r\n}\r\n\r\n.el-timeline {\r\n    padding-left: 20px;\r\n}\r\n</style>"]}]}